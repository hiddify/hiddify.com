---
title: آموزش راه‌اندازی تانل IP-Tables به عنوان سرور میانی
---

# آموزش راه‌اندازی تانل IP-Tables به عنوان سرور میانی


<div align=center dir="rtl" markdown="1">

ابتدا می‌توانید این ویدئو را مشاهده کنید

<a href="https://www.youtube.com/watch?v=kz_Ih__jS9c"><img width="32%" src="https://user-images.githubusercontent.com/125398461/235361165-362e3362-2fd5-4818-95f3-b076801a3135.png" /></a>

</div>

<div dir="rtl" markdown="1">

برای این کار شما به یک سرور میانی نیاز دارید تا از طریق آن به سرور اصلی متصل شوید. معمولا این سرور میانی در کشور محل اقامت در نظر گرفته می‌شود.
<div align=center dir="rtl" markdown="1">
 
<img src="https://user-images.githubusercontent.com/125398461/235339506-bdd76cec-0378-4942-8352-ebebeb006231.png">
</div>

کافی است یک سرور خوب با پهنای باند و سی پی یو مناسب تهیه کنید.
حالا میتوانید چندین سرور میانی ارزان و کم ظرفیت مثلا با رم 256 خریداری کنید که آی پی سالم دارند یا داخل کشور مبدا هستند.


## نصب تنظیمات سرور میانی

حال 
کافی است دستور زیر را در سرور ریلی (سرور میانی) اجرا کنید:
پس از  اجرا از شما سوال میپرسه که آی پی سرور اصلی را وارد کنید.

در جای خواسته شده آی پی سرور اصلی را باید وارد کنید.
<div dir="ltr" markdown="1">
 
```bash
bash <(curl https://gist.githubusercontent.com/hiddify-com/63836c9a158eca29bad6c941610028cf/raw/0e4e2138148ab9d3d678723fd904b1cad461ce62/relay.sh)
```
</div>

## تعریف سرور میانی در هیدیفای‌منیجر
حالا برای آیپی سرور میانی (ایران) خود **یک ساب‌دامین با پروکسی خاموش** ثبت نمایید و آن را در هیدیفای‌منیجر روی حالت Relay ثبت نمایید.

 
![](https://user-images.githubusercontent.com/125398461/235341283-97c026b7-1d70-4362-8950-1e5c1b79d508.png)

## افزودن کانفیگ‌های Relay جهت استفاده به لینک سابسکریپشن
همانند همیشه در هیدیفای‌منیجر بهتر است کانفیگ‌ها را از لینک سابسکریپشن جدا کنید. بنابراین برای دامنه Relay ثبت شده نیز می‌توانید در تنظیمات دامنه مربوط به سابسکریپشن، تیک مربوط به دامین Relay را بزنید تا کانفیگ‌های آن به دامنه سابسکریپشن اضافه گردند.

فرض شود که دامنه مربوط به سابسکریپشن t1.hiddify.com باشد، مطابق با تصویر زیر جلو بروید تا کار انجام شود.

![Screenshot_20230430_1104341](https://user-images.githubusercontent.com/125398461/235342038-cfda2574-2444-4414-843d-2ed507537d1d.png)


حالا اگه صفحه کاربر را با دامین سابسکریپشن (در اینجا `t1.hiddify.com`) باز نمایید خواهید دید که کانکشن‌های مربوط به Relay نیز اضافه شده‌اند. می‌توانید این کانکشن‌ها را به صورت تک تک و یا با استفاده از لینک‌های سابسکریشن معمولی یا سابسکریپشن b64 به کلاینت خود اضافه نمایید و استفاده نمایید.

## حذف کانفیگ‌های انام شده در سرور میانی
برای این کار کافیست کامند زیر را اجرا کنید و رول‌ها را حذف نمایید 
<div dir="ltr" markdown="1">
 
```bash
iptables -F
```
</div>
یا با استفاده از این کامند زنجیرهای ساخته شده راحذف نمایید. 
<div dir="ltr" markdown="1">
 
```bash
iptables -X
```
</div>
تمام!!!!


</div>
